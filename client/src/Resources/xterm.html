<!doctype html>
  <html>
    <head>
      <link rel="stylesheet" href="../../node_modules/xterm/css/xterm.css" />
      <script src="../../node_modules/xterm/lib/xterm.js"></script>
      <script src="socket.io.js"></script>
    </head>
    <body>
      <div id="terminal"></div>
      <script>
        var term = new Terminal();
        term.open(document.getElementById('terminal'));

        socket = io.connect("127.0.0.1:9000");
        socket.emit("setupConnection",JSON.stringify(parseURLParams(window.location.href)));

        socket.on('connect', function () {
            // Browser -> Backend
            term.onKey(e => {
                socket.emit("data", e.key);
            });
        
            // Backend -> Browser
            socket.on('return', function (data) {
                term.write(data.replace(/\r/g, '\n\r'));
            });
        
            socket.on('disconnect', function () {
                term.write('\r\n*** Disconnected from backend***\r\n');
            });
        });
      </script>
    </body>
  </html>